<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>第2讲 ggplot2 数据可视化</title>
    <meta charset="utf-8" />
    <meta name="author" content=" 曾永艺" />
    <meta name="date" content="2023-09-22" />
    <script src="../libs/header-attrs/header-attrs.js"></script>
    <link href="../libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="../libs/tile-view/tile-view.js"></script>
    <link href="../libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <link href="../libs/panelset/panelset.css" rel="stylesheet" />
    <script src="../libs/panelset/panelset.js"></script>
    <link href="../libs/xaringanExtra-extra-styles/xaringanExtra-extra-styles.css" rel="stylesheet" />
    <script src="../libs/clipboard/clipboard.min.js"></script>
    <link href="../libs/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="../libs/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"<i class=\"fa fa-copy\"><\/i>","success":"<i class=\"fa fa-check\" style=\"color: #90BE6D\"><\/i>","error":"<i class=\"fa fa-times-circle\" style=\"color: #F94144\"><\/i>"})</script>
    <link href="../libs/font-awesome/css/all.min.css" rel="stylesheet" />
    <link href="../libs/font-awesome/css/v4-shims.min.css" rel="stylesheet" />
    <link href="../libs/countdown/countdown.css" rel="stylesheet" />
    <script src="../libs/countdown/countdown.js"></script>
    <script src="../libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="../libs/plotly-binding/plotly.js"></script>
    <script src="../libs/typedarray/typedarray.min.js"></script>
    <script src="../libs/jquery/jquery.min.js"></script>
    <link href="../libs/crosstalk/css/crosstalk.min.css" rel="stylesheet" />
    <script src="../libs/crosstalk/js/crosstalk.min.js"></script>
    <link href="../libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="../libs/plotly-main/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="../libs/zen-styles-v2.3-rev.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# 量化金融与金融编程
]
.subtitle[
## L02 ggplot2 数据可视化
]
.author[
### <br>曾永艺
]
.institute[
### 厦门大学管理学院
]
.date[
### <br>2023-09-22
]

---

class: middle, hide_logo
background-image: url(imgs/logo-ggplot2.png)
background-size: 10em
background-position: 90% 50%



<div>
<style type="text/css">.xaringan-extra-logo {
width: 50px;
height: 50px;
z-index: 0;
background-image: url(imgs/logo-sm.png);
background-size: contain;
background-repeat: no-repeat;
position: absolute;
top:0.5em;right:0.5em;
}
</style>
<script>(function () {
  let tries = 0
  function addLogo () {
    if (typeof slideshow === 'undefined') {
      tries += 1
      if (tries < 10) {
        setTimeout(addLogo, 100)
      }
    } else {
      document.querySelectorAll('.remark-slide-content:not(.title-slide):not(.inverse):not(.hide_logo)')
        .forEach(function (slide) {
          const logo = document.createElement('a')
          logo.classList = 'xaringan-extra-logo'
          logo.href = 'https://qfwr2022.netlify.app'
          slide.appendChild(logo)
        })
    }
  }
  document.addEventListener('DOMContentLoaded', addLogo)
})()</script>
</div>

--

- ## .font120[<svg aria-hidden="true" role="img" viewBox="0 0 581 512" style="height:1em;width:1.13em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg>] 的绘图系统

--

- ## `ggplot2` 入门

  - ### The Layered Grammar of Graphics
  
  - ### 将数据映射为几何对象的图形属性
  
  - ### 统计变换、位置调整、坐标、分面
  
  - ### 标签、标注、标度、主题等

--

- ## `ggplot2` extensions

---

### 一图胜千言

&lt;img src="L02_Visualization_files/figure-html/datasaurus-1.png" width="85%" style="display: block; margin: auto;" /&gt;

---
class: inverse, center, middle

# 1. .font120[<svg aria-hidden="true" role="img" viewBox="0 0 581 512" style="height:1em;width:1.13em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg>] 的绘图系统

---

### .font120[<svg aria-hidden="true" role="img" viewBox="0 0 581 512" style="height:1em;width:1.13em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg>] 的绘图系统

&lt;img src="imgs/RGraphics-fig1.14-R-graphics-system.png" width="58%" style="display: block; margin: auto;" /&gt;

---

### .font120[<svg aria-hidden="true" role="img" viewBox="0 0 581 512" style="height:1em;width:1.13em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg>] 基础绘图系统：`graphics`包

.pull-left[

- .font120[高阶绘图函数]
    - **`plot()`**
    - `barplot()`、`pie()`、`dotchart()`、`boxplot()`、`hist()`、
    `stripchart()`、`stem()`、`smoothScatter()`、`spineplot()`、
    `mosaicplot()`、`pairs()`、`matplot()`、`image()`、
    `contour()`、`persp()` ……

- .font120[低阶绘图函数]
    - `points()`、`lines()`、`segments()`、`arrows()`、`xspline()`、`rect()`、`polygon()`、`polypath()`、`rasterImage()`、`title()`、`text()`、`legend()` 等

]

--

.center[示例]

.pull-right[
.code70[

```r
EUSM &lt;- window(EuStockMarkets, 1992, 1994)

plot(EUSM[, "FTSE"], ylim = range(EUSM), 
     xlab = "Time", ylab = "Price", adj = 1, 
     cex.main = 1.5)
lines(EUSM[, "DAX"], lty = "dashed")
title(main = "Index's Price")
legend(1992, 3450, c("FTSE", "DAX"), 
       lty = c("solid", "dashed"), bty = "n")
```

&lt;img src="L02_Visualization_files/figure-html/EUSM-1.png" style="display: block; margin: auto;" /&gt;
]
]

---
class: inverse, center, middle
background-image: url(imgs/logo-ggplot2.svg)
background-size: 12%
background-position: 18% 50%

# 2. `ggplot2`&lt;sup&gt;.font60[v3.4.3]&lt;/sup&gt; 入门

---
layout: true

### .bold[2.1 The Layered Grammar of Graphics]

---

--

.font130[_Data Visualization_：将.bold[数据]映射为.bold[几何对象的美学属性]]

.font110[

- 数据（.red[data]）：我们想要可视化的对象，包含变量
- 几何对象（.red[geom]etries)：用来呈现数据的几何图形对象，如点、条形、线条等
- 美学属性（.red[aes]thetic）：几何对象的视觉属性，如`x`坐标和`y`坐标位置、颜色、形状等

]

&lt;img src="imgs/visualization-stat-point.png" width="100%" style="display: block; margin: auto;" /&gt;

---

.font130[`ggplot2` 的语法模板]

.code150[


```r
*ggplot(data = &lt;DATA&gt;) +
* &lt;GEOM_FUNCTION&gt;(
*    mapping = aes(&lt;MAPPINGS&gt;),
     stat = &lt;STAT&gt;, 
     position = &lt;POSITION&gt;
  ) +
  &lt;COORDINATE_FUNCTION&gt; +
  &lt;FACET_FUNCTION&gt;
```
]

---
layout: true

### .bold[2.2 将.red[数据]映射为几何对象的美学属性]

---


```r
library(tidyverse)
```

--


```r
mpg  # print(mpg)
```

```
#&gt; # A tibble: 234 × 11
#&gt;   manufacturer model displ  year   cyl trans      drv     cty   hwy fl    class  
#&gt;   &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;  
#&gt; 1 audi         a4      1.8  1999     4 auto(l5)   f        18    29 p     compact
#&gt; 2 audi         a4      1.8  1999     4 manual(m5) f        21    29 p     compact
#&gt; 3 audi         a4      2    2008     4 manual(m6) f        20    31 p     compact
#&gt; # ℹ 231 more rows
```

--


```r
# 查看ggplot2包内置数据集mpg的帮助文档
?mpg  # help(mpg)
```

--

1. `displ`: a car's engine size, in litres.
2. `hwy`: a car's fuel efficiency on the highway, in miles per gallon (mpg). 
3. `class`: "type" of car  
...

---
layout: true

### .bold[2.2 将数据.red[映射为几何对象的美学属性]]

---
count: false


```r
ggplot()
```

&lt;img src="L02_Visualization_files/figure-html/mapping1-1-1.png" width="60%" style="display: block; margin: auto;" /&gt;

---
count: false


```r
ggplot(data = mpg)                           # 数据集
```

&lt;img src="L02_Visualization_files/figure-html/mapping1-2-1.png" width="60%" style="display: block; margin: auto;" /&gt;

---
count: false


```r
ggplot(data = mpg,                           # 数据集
       mapping = aes(x = displ, y = hwy))    # 映射：变量 -&gt; x坐标和y坐标
```

&lt;img src="L02_Visualization_files/figure-html/mapping1-3-1.png" width="60%" style="display: block; margin: auto;" /&gt;

---
count: false


```r
ggplot(data = mpg,                           # 数据集
       mapping = aes(x = displ, y = hwy)) +  # 映射：变量 -&gt; x坐标和y坐标
  geom_point()                               # 几何对象
```

&lt;img src="L02_Visualization_files/figure-html/mapping1-4-1.png" width="60%" style="display: block; margin: auto;" /&gt;

---


```r
g_mpg &lt;- ggplot(data = mpg,                           # 数据集
                mapping = aes(x = displ, y = hwy)) +  # 映射：变量 -&gt; x坐标和y坐标
           geom_point()                               # 几何对象
```

--
.pull-left[

```r
print(g_mpg)
```

&lt;img src="L02_Visualization_files/figure-html/mapping1-6-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

--
.pull-right[

```r
names(g_mpg)
```

```
#&gt; [1] "data"        "layers"     
#&gt; [3] "scales"      "mapping"    
#&gt; [5] "theme"       "coordinates"
#&gt; [7] "facet"       "plot_env"   
#&gt; [9] "labels"
```

```r
str(g_mpg)  # View(g_mpg)
```

```
#&gt; List of 9
#&gt;  $ data       : tibble [234 × 11] (S3: tbl_df/tbl/data.frame)
#&gt;   ..$ manufacturer: chr [1:234] "audi" "audi" "audi" "audi" ...
#&gt;   ..$ model       : chr [1:234] "a4" "a4" "a4" "a4" ...
#&gt;   ..$ displ       : num [1:234] 1.8 1.8 2 2 2.8 2.8 3.1 1.8 1.8 2 ...
#&gt;   ..$ year        : int [1:234] 1999 1999 2008 2008 1999 1999 2008 1999 1999 2008 ...
#&gt;   ..$ cyl         : int [1:234] 4 4 4 4 6 6 6 4 4 4 ...
#&gt;   ..$ trans       : chr [1:234] "auto(l5)" "manual(m5)" "manual(m6)" "auto(av)" ...
#&gt;   ..$ drv         : chr [1:234] "f" "f" "f" "f" ...
#&gt;   ..$ cty         : int [1:234] 18 21 20 21 16 18 18 18 16 20 ...
#&gt;   ..$ hwy         : int [1:234] 29 29 31 30 26 26 27 26 25 28 ...
#&gt;   ..$ fl          : chr [1:234] "p" "p" "p" "p" ...
#&gt;   ..$ class       : chr [1:234] "compact" "compact" "compact" "compact" ...
#&gt;  $ layers     :List of 1
#&gt;   ..$ :Classes 'LayerInstance', 'Layer', 'ggproto', 'gg' &lt;ggproto object: Class LayerInstance, Layer, gg&gt;
#&gt;     aes_params: list
#&gt;     compute_aesthetics: function
#&gt;     compute_geom_1: function
#&gt;     compute_geom_2: function
#&gt;     compute_position: function
#&gt;     compute_statistic: function
#&gt;     computed_geom_params: list
#&gt;     computed_mapping: uneval
#&gt;     computed_stat_params: list
#&gt;     constructor: call
#&gt;     data: waiver
#&gt;     draw_geom: function
#&gt;     finish_statistics: function
#&gt;     geom: &lt;ggproto object: Class GeomPoint, Geom, gg&gt;
#&gt;         aesthetics: function
#&gt;         default_aes: uneval
#&gt;         draw_group: function
#&gt;         draw_key: function
#&gt;         draw_layer: function
#&gt;         draw_panel: function
#&gt;         extra_params: na.rm
#&gt;         handle_na: function
#&gt;         non_missing_aes: size shape colour
#&gt;         optional_aes: 
#&gt;         parameters: function
#&gt;         rename_size: FALSE
#&gt;         required_aes: x y
#&gt;         setup_data: function
#&gt;         setup_params: function
#&gt;         use_defaults: function
#&gt;         super:  &lt;ggproto object: Class Geom, gg&gt;
#&gt;     geom_params: list
#&gt;     inherit.aes: TRUE
#&gt;     layer_data: function
#&gt;     map_statistic: function
#&gt;     mapping: NULL
#&gt;     position: &lt;ggproto object: Class PositionIdentity, Position, gg&gt;
#&gt;         compute_layer: function
#&gt;         compute_panel: function
#&gt;         required_aes: 
#&gt;         setup_data: function
#&gt;         setup_params: function
#&gt;         super:  &lt;ggproto object: Class Position, gg&gt;
#&gt;     print: function
#&gt;     setup_layer: function
#&gt;     show.legend: NA
#&gt;     stat: &lt;ggproto object: Class StatIdentity, Stat, gg&gt;
#&gt;         aesthetics: function
#&gt;         compute_group: function
#&gt;         compute_layer: function
#&gt;         compute_panel: function
#&gt;         default_aes: uneval
#&gt;         dropped_aes: 
#&gt;         extra_params: na.rm
#&gt;         finish_layer: function
#&gt;         non_missing_aes: 
#&gt;         optional_aes: 
#&gt;         parameters: function
#&gt;         required_aes: 
#&gt;         retransform: TRUE
#&gt;         setup_data: function
#&gt;         setup_params: function
#&gt;         super:  &lt;ggproto object: Class Stat, gg&gt;
#&gt;     stat_params: list
#&gt;     super:  &lt;ggproto object: Class Layer, gg&gt; 
#&gt;  $ scales     :Classes 'ScalesList', 'ggproto', 'gg' &lt;ggproto object: Class ScalesList, gg&gt;
#&gt;     add: function
#&gt;     clone: function
#&gt;     find: function
#&gt;     get_scales: function
#&gt;     has_scale: function
#&gt;     input: function
#&gt;     n: function
#&gt;     non_position_scales: function
#&gt;     scales: list
#&gt;     super:  &lt;ggproto object: Class ScalesList, gg&gt; 
#&gt;  $ mapping    :List of 2
#&gt;   ..$ x: language ~displ
#&gt;   .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
#&gt;   ..$ y: language ~hwy
#&gt;   .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
#&gt;   ..- attr(*, "class")= chr "uneval"
#&gt;  $ theme      : list()
#&gt;  $ coordinates:Classes 'CoordCartesian', 'Coord', 'ggproto', 'gg' &lt;ggproto object: Class CoordCartesian, Coord, gg&gt;
#&gt;     aspect: function
#&gt;     backtransform_range: function
#&gt;     clip: on
#&gt;     default: TRUE
#&gt;     distance: function
#&gt;     expand: TRUE
#&gt;     is_free: function
#&gt;     is_linear: function
#&gt;     labels: function
#&gt;     limits: list
#&gt;     modify_scales: function
#&gt;     range: function
#&gt;     render_axis_h: function
#&gt;     render_axis_v: function
#&gt;     render_bg: function
#&gt;     render_fg: function
#&gt;     setup_data: function
#&gt;     setup_layout: function
#&gt;     setup_panel_guides: function
#&gt;     setup_panel_params: function
#&gt;     setup_params: function
#&gt;     train_panel_guides: function
#&gt;     transform: function
#&gt;     super:  &lt;ggproto object: Class CoordCartesian, Coord, gg&gt; 
#&gt;  $ facet      :Classes 'FacetNull', 'Facet', 'ggproto', 'gg' &lt;ggproto object: Class FacetNull, Facet, gg&gt;
#&gt;     compute_layout: function
#&gt;     draw_back: function
#&gt;     draw_front: function
#&gt;     draw_labels: function
#&gt;     draw_panels: function
#&gt;     finish_data: function
#&gt;     init_scales: function
#&gt;     map_data: function
#&gt;     params: list
#&gt;     setup_data: function
#&gt;     setup_params: function
#&gt;     shrink: TRUE
#&gt;     train_scales: function
#&gt;     vars: function
#&gt;     super:  &lt;ggproto object: Class FacetNull, Facet, gg&gt; 
#&gt;  $ plot_env   :&lt;environment: R_GlobalEnv&gt; 
#&gt;  $ labels     :List of 2
#&gt;   ..$ x: chr "displ"
#&gt;   ..$ y: chr "hwy"
#&gt;  - attr(*, "class")= chr [1:2] "gg" "ggplot"
```
]

---


```r
ggplot(data = mpg) + 
  geom_point(
*   mapping = aes(x = displ, y = hwy, colour = class)  # 3个映射
  )
```

&lt;img src="L02_Visualization_files/figure-html/mapping2-1.png" width="60%" style="display: block; margin: auto;" /&gt;

---


```r
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, shape = class))
```

```
#&gt; Warning: The shape palette can deal with a maximum of 6 discrete values because more than
#&gt; 6 becomes difficult to discriminate; you have 7. Consider specifying shapes
#&gt; manually if you must have them.
```

```
#&gt; Warning: Removed 62 rows containing missing values (`geom_point()`).
```

&lt;img src="L02_Visualization_files/figure-html/mapping3-1.png" width="60%" style="display: block; margin: auto;" /&gt;

---

.font120[
- R内置有25个形状（shape），在`ggplot2`中可用名字或数字进行设定
]
.pull-left[
&lt;img src="L02_Visualization_files/figure-html/shapes-name-1.png" width="95%" style="display: block; margin: auto;" /&gt;

]

--

.pull-right[
&lt;img src="L02_Visualization_files/figure-html/shapes-id-1.png" width="95%" style="display: block; margin: auto;" /&gt;

]

--

.font120[
- 设定图形属性相关的说明文档 .content-box-yellow.font80[`vignette("ggplot2-specs")`]
]

---


```r
ggplot(data = mpg) + 
  geom_point(
    mapping = aes(x = displ, y = hwy), 
*   shape = "triangle", size = 3, colour = "red", alpha = 0.3
    # 变量无关（“大家都一样”，即非映射）的几何对象图形属性应在aes()外进行设定
  )
```

&lt;img src="L02_Visualization_files/figure-html/mapping4-1.png" width="55%" style="display: block; margin: auto;" /&gt;

---


```r
# layered!
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) +
* geom_smooth(mapping = aes(x = displ, y = hwy))  # layered!
```

&lt;img src="L02_Visualization_files/figure-html/mapping5-1.png" width="58%" style="display: block; margin: auto;" /&gt;

---


```r
ggplot(
  data = mpg,
* mapping = aes(x = displ, y = hwy)  # 共用映射，提前至ggplot()中
) +
  geom_point() +
  geom_smooth()
```

&lt;img src="L02_Visualization_files/figure-html/mapping6-1.png" width="56%" style="display: block; margin: auto;" /&gt;

---


```r
*ggplot(mpg, aes(displ, hwy)) +       # 省略常用参数名
* geom_point(aes(colour = class)) +  # 图层自用映射
* geom_smooth(data = filter(mpg, class == "pickup"))  # 不同的数据集
```

&lt;img src="L02_Visualization_files/figure-html/mapping7-1.png" width="65%" style="display: block; margin: auto;" /&gt;

---
layout: false
class: hide_logo

## 🙋‍♂️ Your Turn! 

&lt;style type="text/css"&gt;
#special_timer.running {
  background-color: black;
  background-image: url(imgs/bg-stars.gif);
}
#special_timer.finished {
  background-color: black;
  background-image: url(imgs/bg-sqfw.gif);
  background-size: cover;
}
#special_timer.running .countdown-digits {
  color: #fdf6e3;
}
#special_timer.finished .countdown-digits {
  color: #fdf6e3;
}
&lt;/style&gt;

<div class="countdown" id="special_timer" data-warn-when="10" data-update-every="1" tabindex="0" style="top:0;right:0;font-size:3em;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

&lt;br&gt;

.pull-left[

.font120[在 RStudio控制台 中输入以下代码（高亮处填补恰当内容——记得善用.kbd[`F1`] ），从而得到右边所示的图形：]




&lt;code class ='r hljs remark-code'&gt;library(ggplot2)&lt;br&gt;&lt;br&gt;ggplot(economics) + &lt;br&gt;&amp;nbsp;&amp;nbsp;geom_hline(&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="background-color:#ffff7f"&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt; = 3.5, &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="background-color:#ffff7f"&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt; = 'white', &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;span style="background-color:#ffff7f"&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt; = 2&lt;br&gt;&amp;nbsp;&amp;nbsp;) +&lt;br&gt;&amp;nbsp;&amp;nbsp;geom&lt;span style="background-color:#ffff7f"&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;(&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;aes(x = &lt;span style="background-color:#ffff7f"&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;, &lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;y = &lt;span style="background-color:#ffff7f"&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;)&lt;br&gt;&amp;nbsp;&amp;nbsp;)&lt;/code&gt;


&lt;img src="L02_Visualization_files/figure-html/yt-0-flaired-1.png" width="0.1" /&gt;
]

.pull-right[

&lt;br&gt;&lt;br&gt;

&lt;img src="L02_Visualization_files/figure-html/yt-2-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---
layout: true

### .bold[2.3 .red[统计变换]、位置调整、坐标、分面]

---


```r
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut))
```

--

&lt;img src="L02_Visualization_files/figure-html/stat2-1.png" width="65%" style="display: block; margin: auto;" /&gt;

.red.font110[Where comes the "count" in y-axis? 😅]

---

&lt;img src="imgs/visualization-stat-bar.png" width="100%" style="display: block; margin: auto;" /&gt;

--

.font110[下面的代码会得到和使用 `geom_bar()` 相同的结果]


```r
ggplot(data = diamonds) + 
* stat_count(mapping = aes(x = cut))
```

---


```r
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, 
                         y = after_stat(prop),   # ?aes_eval
                         group = 1))             # ?aes_group_order
```

&lt;img src="L02_Visualization_files/figure-html/stat3-2-1.png" width="60%" style="display: block; margin: auto;" /&gt;

---


```r
ggplot(data = diamonds %&gt;% group_by(cut) %&gt;% count()) +  # what's this?!
  geom_bar(
    mapping = aes(x = cut, y = n),
*   stat = "identity"
  )
```

&lt;img src="L02_Visualization_files/figure-html/stat4-1.png" width="58%" style="display: block; margin: auto;" /&gt;

---
layout: true

### .bold[2.3 统计变换、.red[位置调整]、坐标、分面]

---

```r
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = clarity))
# geom_bar()默认的position = "stack"
```

&lt;img src="L02_Visualization_files/figure-html/pos1-1.png" width="65%" style="display: block; margin: auto;" /&gt;

---


```r
ggplot(data = diamonds) + 
  geom_bar(
    mapping = aes(x = cut, fill = clarity),
*   position = "dodge"  # position = position_dodge(width = 0.9)
  )
```

&lt;img src="L02_Visualization_files/figure-html/pos2-1.png" width="58%" style="display: block; margin: auto;" /&gt;

---


```r
ggplot(data = mpg) + 
  geom_point(
    mapping = aes(x = displ, y = hwy),
*   position = "jitter"   # same as `ggplot() + geom_jitter()`
  )
```

&lt;img src="L02_Visualization_files/figure-html/pos3-1.png" width="58%" style="display: block; margin: auto;" /&gt;

---
layout: true

### .bold[2.3 统计变换、位置调整、.red[坐标]、分面]

---


```r
ggplot(data = mpg, mapping = aes(x = class, y = hwy)) + 
  geom_boxplot() +
* coord_flip()  # ggplot2 3.3.0后直接调换x，y参数即可
```

&lt;img src="L02_Visualization_files/figure-html/coord1-1.png" width="65%" style="display: block; margin: auto;" /&gt;

---


```r
bar &lt;- ggplot(data = diamonds) +  # 将图形对象存为变量bar，可在Environment标签页中检查其内容
  geom_bar(
    mapping = aes(x = cut, fill = cut), show.legend = FALSE, width = 1
  ) + 
  theme(aspect.ratio = 1) + labs(x = NULL, y = NULL)
*bar + coord_polar()
```

&lt;img src="L02_Visualization_files/figure-html/coord2-1.png" width="35%" style="display: block; margin: auto;" /&gt;


---
layout: true

### .bold[2.3 统计变换、位置调整、坐标、.red[分面]]

---


```r
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(data = mutate(mpg, class = NULL), colour = "grey") +
  geom_point() + 
* facet_wrap(vars(class), nrow = 2) # facet_wrap(~ class, nrow = 2)
```

&lt;img src="L02_Visualization_files/figure-html/facet1-1.png" width="65%" style="display: block; margin: auto;" /&gt;

---


```r
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(data = transform(mpg, cyl = NULL), colour = "grey") +
  geom_point() + 
* facet_grid(rows = vars(drv), cols = vars(cyl))  # facet_grid(drv ~ cyl)
```

&lt;img src="L02_Visualization_files/figure-html/facet2-1.png" width="65%" style="display: block; margin: auto;" /&gt;

---
layout: true

### .bold[2.4 .red[标签]、标注、标度、主题等]

---


```r
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(colour = class)) +
  geom_smooth(se = FALSE) +
* labs(  # 标题、小标题等
*   title = "Fuel efficiency",
*   subtitle = "... generally decreases with engine size",
*   caption = "Data from fueleconomy.gov"
* )
```

&lt;img src="L02_Visualization_files/figure-html/labs1-1.png" width="50%" style="display: block; margin: auto;" /&gt;

---


```r
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(colour = class)) +
  geom_smooth(se = FALSE) +
* labs( # 图形属性 = 标签
*   x = "Engine displacement (L)",
*   y = "Highway fuel economy (mpg)",
*   colour = "Car type"
* )
```

&lt;img src="L02_Visualization_files/figure-html/labs2-1.png" width="50%" style="display: block; margin: auto;" /&gt;

---
layout: true

### .bold[2.4 标签、.red[标注]、标度、主题等]

---


```r
# 生成辅助数据集
best &lt;- mpg %&gt;%
  group_by(class) %&gt;%
  filter(row_number(desc(hwy)) == 1)
```

--

.pull-left[


```r
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(colour = class)) +
* geom_text(
    aes(label = model), 
    data = best
  )
```

&lt;img src="L02_Visualization_files/figure-html/label1-1.png" width="85%" style="display: block; margin: auto;" /&gt;

]

--

.pull-right[


```r
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(colour = class)) +
* geom_label(
    aes(label = model), data = best, 
    nudge_y = 2, alpha = 0.5
  )
```

&lt;img src="L02_Visualization_files/figure-html/label2-1.png" width="85%" style="display: block; margin: auto;" /&gt;

]

---


```r
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(colour = class)) +
* geom_point(size = 3, shape = 1, data = best) +
* ggrepel::geom_label_repel(aes(label = model), data = best)  # install ggrepel
```

&lt;img src="L02_Visualization_files/figure-html/label3-1.png" width="65%" style="display: block; margin: auto;" /&gt;

---

.pull-left.code75[

```r
*library(ggtext)  # install it!

# 辅助数据
beetle &lt;- mpg %&gt;% 
  filter(model == "new beetle") %&gt;% 
  filter(hwy == max(hwy)) %&gt;% 
  mutate(model = 
         "&lt;img src='imgs/beetle.png' 
         width='25'/&gt;")

ggplot(mpg, aes(displ, hwy)) + 
  geom_point(aes(colour = class)) + 
* geom_richtext(
    data = beetle,
    aes(label = model),
    fill = NA, colour = NA, 
    hjust = 0, vjust = 0.5
  ) + 
  labs(
    title = "&lt;b&gt;Fuel efficiency&lt;/b&gt;&lt;br&gt;
    &lt;span style='color:red;font-size:12pt'&gt;
    ... generally **_decreases_** with
    engine size&lt;/span&gt;"
  ) -&gt; p
```
]

.pull-right.code75[

```r
p + theme(
  plot.title.position = "plot",
* plot.title = element_textbox_simple(
    size = 15, lineheight = 1.2,
    padding = margin(5.5, 5.5, 5.5, 5.5),
    margin = margin(0, 0, 5.5, 0),
    linetype = 1,
    r = grid::unit(8, "pt"),
    fill = "#F0F7FF"
  ))
```

&lt;img src="L02_Visualization_files/figure-html/label4-2-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---
layout: true

### .bold[2.4 标签、标注、.red[标度]、主题等]

---


```r
ggplot(diamonds, aes(carat, price)) +
  geom_bin2d() + 
* scale_x_log10() +
* scale_y_log10()
```

&lt;img src="L02_Visualization_files/figure-html/scale1-1.png" width="65%" style="display: block; margin: auto;" /&gt;

---


```r
ggplot(mpg, aes(displ, hwy)) +
  geom_point() +
* scale_y_continuous(
    name = "Highway fuel economy (mpg)",
    breaks = seq(0, 50, by = 10),
    limits = c(0, 100),
    expand = expansion(mult = 0.09, add = 1)
  )
```

&lt;img src="L02_Visualization_files/figure-html/scale2-1.png" width="55%" style="display: block; margin: auto;" /&gt;

---


```r
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(colour = drv, shape = drv)) +
* scale_colour_brewer(palette = "Set1")   # RColorBrewer::display.brewer.all()
```

&lt;img src="L02_Visualization_files/figure-html/scale3-1.png" width="65%" style="display: block; margin: auto;" /&gt;

---


```r
ggplot(mpg, aes(displ, hwy, colour = class)) +
  geom_point() +
* theme(legend.position = "bottom") +
  guides(
*   colour = guide_legend(nrow = 1, override.aes = list(size = 3))
  )
```

&lt;img src="L02_Visualization_files/figure-html/scale4-1.png" width="55%" style="display: block; margin: auto;" /&gt;

---
layout: true

### .bold[2.4 标签、标注、标度、.red[主题]等]

---

.pull-left[

```r
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(colour = class)) +
  geom_smooth(se = FALSE) +
* theme_minimal()
```

&lt;img src="L02_Visualization_files/figure-html/theme1-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

--

.pull-right[

```r
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(colour = class)) +
  geom_smooth(se = FALSE) +
* ggthemes::theme_stata()   # install it!
```

&lt;img src="L02_Visualization_files/figure-html/theme2-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

.code80[

```r
theme(line, rect, text, title, aspect.ratio, axis.title, axis.title.x,
      axis.title.x.top, axis.title.x.bottom, axis.title.y, axis.title.y.left,
      axis.title.y.right, axis.text, axis.text.x, axis.text.x.top,
      axis.text.x.bottom, axis.text.y, axis.text.y.left, axis.text.y.right,
      axis.ticks, axis.ticks.x, axis.ticks.x.top, axis.ticks.x.bottom, axis.ticks.y,
      axis.ticks.y.left, axis.ticks.y.right, axis.ticks.length, axis.ticks.length.x,
      axis.ticks.length.x.top, axis.ticks.length.x.bottom, axis.ticks.length.y,
      axis.ticks.length.y.left, axis.ticks.length.y.right, axis.line, axis.line.x,
      axis.line.x.top, axis.line.x.bottom, axis.line.y, axis.line.y.left,
      axis.line.y.right, legend.background, legend.margin, legend.spacing,
      legend.spacing.x, legend.spacing.y, legend.key, legend.key.size,
      legend.key.height, legend.key.width, legend.text, legend.text.align,
      legend.title, legend.title.align, legend.position, legend.direction,
      legend.justification, legend.box, legend.box.just, legend.box.margin,
      legend.box.background, legend.box.spacing, panel.background, panel.border,
      panel.spacing, panel.spacing.x, panel.spacing.y, panel.grid, panel.grid.major,
      panel.grid.minor, panel.grid.major.x, panel.grid.major.y, panel.grid.minor.x,
      panel.grid.minor.y, panel.ontop, plot.background, plot.title,
      plot.title.position, plot.subtitle, plot.caption, plot.caption.position,
      plot.tag, plot.tag.position, plot.margin, strip.background, strip.background.x,
      strip.background.y, strip.clip, strip.placement, strip.text, strip.text.x,
      strip.text.x.bottom, strip.text.x.top, strip.text.y, strip.text.y.left,
      strip.text.y.right, strip.switch.pad.grid, strip.switch.pad.wrap, ...,
      complete = FALSE, validate = TRUE)
```
]

---

&lt;iframe src="https://rstudio.github.io/thematic/" width="100%" height="550px" data-external="1"&gt;&lt;/iframe&gt;

---
layout: false
class: hide_logo

## 🙋‍♂️ Your Turn! 

<div class="countdown" id="special_timer" data-warn-when="10" data-update-every="1" tabindex="0" style="top:0;right:0;font-size:3em;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">10</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

&lt;br&gt;

.pull-left[

.font120[在 RStudio控制台 中输入恰当的代码从而得到右边所示的图形：]




```r
# install.packages("palmerpenguins")
# install.packages("ggthemes")
library(ggplot2)
library(ggthemes)

palmerpenguins::penguins %&gt;% 
  ...
```
]

.pull-right[

&lt;br&gt;&lt;br&gt;

&lt;img src="L02_Visualization_files/figure-html/pg-2-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]


---
layout: false
class: inverse, center, middle

# 3. `ggplot2` extensions and ...

---
class: hide_logo
background-image: url(imgs/logo-esquisse.png)
background-size: 5%
background-position: 5% 3%

### &amp;emsp;&amp;emsp;`esquisse`&lt;sup&gt;.font60[v1.1.2]&lt;/sup&gt;

.pull-left.font110[

&gt; This `esquisse` addin allows you to interactively 
&gt; explore your data by visualizing it with the `ggplot2` 
&gt; package. It allows you to draw bar plots, curves, 
&gt; scatter plots, histograms, boxplot and sf objects, 
&gt; then export the graph or retrieve the code to reproduce 
&gt; the graph.

&lt;br&gt;

```r
# install.packages("esquisse")

# RStudio Addins -&gt; 'ggplot2' builder
esquisse::esquisser()
```

]

--

.pull-right[

&lt;br&gt;

&lt;img src="imgs/esquisse.gif" width="100%" style="display: block; margin: auto auto auto 0;" /&gt;

]

---
class: hide_logo
background-image: url(imgs/logo-patchwork.png)
background-size: 5%
background-position: 5% 3%

### &amp;emsp;&amp;emsp;`patchwork`&lt;sup&gt;.font60[v1.1.3]&lt;/sup&gt;

.pull-left.font110[

&gt; `patchwork` expands the API to allow 
&gt; for arbitrarily complex composition of 
&gt; plots by, among others, providing 
&gt; mathematical operators for combining 
&gt; multiple plots.


```r
# install.packages("patchwork")
library(patchwork)

p &lt;- ggplot(mtcars)

p1 &lt;- p + geom_point(aes(mpg, disp))

p2 &lt;- p + geom_boxplot(
        aes(gear, disp, group = gear))

p3 &lt;- p + geom_smooth(aes(disp, qsec))

p4 &lt;- p + geom_bar(aes(carb))
```

]

--
  
.pull-right[


```r
p1 + plot_spacer() + {
  p2 + p3 + plot_layout(ncol = 1)
} + plot_layout(nrow = 1, 
                widths = c(1, 0.25, 1)) -
  p4 + plot_layout(ncol = 1) +
  plot_annotation(title = "Fancy plot!", 
                  tag_levels = "A")
```

&lt;img src="L02_Visualization_files/figure-html/patchwork-1.png" width="95%" style="display: block; margin: auto;" /&gt;
]

---
class: hide_logo
background-image: url(imgs/logo-gganimate.png)
background-size: 5%
background-position: 5% 3%

### &amp;emsp;&amp;emsp;`gganimate`&lt;sup&gt;.font60[v1.0.8]&lt;/sup&gt;

.pull-left[
&lt;br&gt;

```r
# install.packages("gganimate")
# install.packages("gifski")
# install.packages("gapminder")

library(gganimate)
library(gapminder)

p &lt;- ggplot(gapminder,
            aes(gdpPercap, lifeExp, 
                size = pop, 
                colour = country)) +
  geom_point(alpha = 0.7, 
             show.legend = FALSE) +
  scale_colour_manual(
    values = country_colors
  ) +
  scale_size(range = c(2, 12)) +
  scale_x_log10() +
  facet_wrap(vars(continent))
```
]

--
  
.pull-right[


```r
# Here comes the gganimate specific bits
*p + labs(title = 'Year: {frame_time}',
         x = 'GDP per capita', 
         y = 'life expectancy') +  
* transition_time(year) +
* ease_aes('linear')
```

&lt;img src="L02_Visualization_files/figure-html/gganimate-1.gif" width="100%" style="display: block; margin: auto;" /&gt;

&lt;!-- ![](L02_Visualization_files/figure-html/gganimate-1.gif) --&gt;

]

---
class: hide_logo
background-image: url(imgs/logo-plotly.png)
background-size: 5%
background-position: 5% 3%

### &amp;emsp;&amp;emsp;`plotly`&lt;sup&gt;.font60[v4.10.2]&lt;/sup&gt;

.pull-left.font110[

&gt; Create interactive web graphics from `ggplot2` graphs 
&gt; and/or a custom interface to the 'plotly.js' 
&gt; inspired by the _grammar of graphics_.


```r
# install.packages("plotly")
*library(plotly)

p &lt;- gapminder %&gt;%
  filter(year == 2007) %&gt;%
  ggplot(aes(gdpPercap, lifeExp, 
             size = pop, 
             color = continent)) + 
  geom_point() + 
  scale_x_log10() + 
  theme_bw()
 
*ggplotly(p)
```
]

--

.pull-right[

&lt;br&gt;

<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-2509666ca3e79b8b7051" style="width:100%;height:65%;"></div>
<script type="application/json" data-for="htmlwidget-2509666ca3e79b8b7051">{"x":{"data":[{"x":[3.7940254450966644,3.6809906556268164,3.1587498285200959,4.0993301562976825,3.0853023521971163,2.6335398473202094,3.3100759930113757,2.8488148736349985,3.2314858313133699,2.9939420450679588,2.443344140046372,3.5602125331291146,3.1888582353745463,3.3185811659560813,3.7467261069384517,4.0847224390037145,2.8071083194109296,2.8393558343569567,4.120787226641542,2.8766506063906259,3.1230701584328973,2.9743524119826992,2.7628523540039867,3.1653183196828425,3.195714676047237,2.6175322269121151,4.0812572446605149,3.0190207459573766,2.8804419458658828,3.0181100381010961,3.2560322165243099,4.0396913096789095,3.5820832842930348,2.9157614843495785,3.6822408118633683,2.7921653017164396,3.3040545722906871,3.884802303432406,2.9360553118387509,3.2036950046605677,3.2336235137236495,2.9357796251727324,2.9666771427490164,3.9670637023386344,3.4153732150271123,3.6545115842375888,3.0443367476975203,2.9459459204926648,3.8508252467512323,3.0238202200422353,3.1042178448294138,2.6718291573166399],"y":[72.301000000000002,42.731000000000002,56.728000000000002,50.728000000000002,52.295000000000002,49.579999999999998,50.43,44.741,50.651000000000003,65.152000000000001,46.462000000000003,55.322000000000003,48.328000000000003,54.790999999999997,71.337999999999994,51.579000000000001,58.039999999999999,52.947000000000003,56.734999999999999,59.448,60.021999999999998,56.006999999999998,46.387999999999998,54.109999999999999,42.591999999999999,45.677999999999997,73.951999999999998,59.442999999999998,48.302999999999997,54.466999999999999,64.164000000000001,72.801000000000002,71.164000000000001,42.082000000000001,52.905999999999999,56.866999999999997,46.859000000000002,76.441999999999993,46.241999999999997,65.528000000000006,63.061999999999998,42.567999999999998,48.158999999999999,49.338999999999999,58.555999999999997,39.613,52.517000000000003,58.420000000000002,73.923000000000002,51.542000000000002,42.384,43.487000000000002],"text":["gdpPercap:  6223<br />lifeExp: 72.3<br />pop:   33333216<br />continent: Africa","gdpPercap:  4797<br />lifeExp: 42.7<br />pop:   12420476<br />continent: Africa","gdpPercap:  1441<br />lifeExp: 56.7<br />pop:    8078314<br />continent: Africa","gdpPercap: 12570<br />lifeExp: 50.7<br />pop:    1639131<br />continent: Africa","gdpPercap:  1217<br />lifeExp: 52.3<br />pop:   14326203<br />continent: Africa","gdpPercap:   430<br />lifeExp: 49.6<br />pop:    8390505<br />continent: Africa","gdpPercap:  2042<br />lifeExp: 50.4<br />pop:   17696293<br />continent: Africa","gdpPercap:   706<br />lifeExp: 44.7<br />pop:    4369038<br />continent: Africa","gdpPercap:  1704<br />lifeExp: 50.7<br />pop:   10238807<br />continent: Africa","gdpPercap:   986<br />lifeExp: 65.2<br />pop:     710960<br />continent: Africa","gdpPercap:   278<br />lifeExp: 46.5<br />pop:   64606759<br />continent: Africa","gdpPercap:  3633<br />lifeExp: 55.3<br />pop:    3800610<br />continent: Africa","gdpPercap:  1545<br />lifeExp: 48.3<br />pop:   18013409<br />continent: Africa","gdpPercap:  2082<br />lifeExp: 54.8<br />pop:     496374<br />continent: Africa","gdpPercap:  5581<br />lifeExp: 71.3<br />pop:   80264543<br />continent: Africa","gdpPercap: 12154<br />lifeExp: 51.6<br />pop:     551201<br />continent: Africa","gdpPercap:   641<br />lifeExp: 58.0<br />pop:    4906585<br />continent: Africa","gdpPercap:   691<br />lifeExp: 52.9<br />pop:   76511887<br />continent: Africa","gdpPercap: 13206<br />lifeExp: 56.7<br />pop:    1454867<br />continent: Africa","gdpPercap:   753<br />lifeExp: 59.4<br />pop:    1688359<br />continent: Africa","gdpPercap:  1328<br />lifeExp: 60.0<br />pop:   22873338<br />continent: Africa","gdpPercap:   943<br />lifeExp: 56.0<br />pop:    9947814<br />continent: Africa","gdpPercap:   579<br />lifeExp: 46.4<br />pop:    1472041<br />continent: Africa","gdpPercap:  1463<br />lifeExp: 54.1<br />pop:   35610177<br />continent: Africa","gdpPercap:  1569<br />lifeExp: 42.6<br />pop:    2012649<br />continent: Africa","gdpPercap:   415<br />lifeExp: 45.7<br />pop:    3193942<br />continent: Africa","gdpPercap: 12057<br />lifeExp: 74.0<br />pop:    6036914<br />continent: Africa","gdpPercap:  1045<br />lifeExp: 59.4<br />pop:   19167654<br />continent: Africa","gdpPercap:   759<br />lifeExp: 48.3<br />pop:   13327079<br />continent: Africa","gdpPercap:  1043<br />lifeExp: 54.5<br />pop:   12031795<br />continent: Africa","gdpPercap:  1803<br />lifeExp: 64.2<br />pop:    3270065<br />continent: Africa","gdpPercap: 10957<br />lifeExp: 72.8<br />pop:    1250882<br />continent: Africa","gdpPercap:  3820<br />lifeExp: 71.2<br />pop:   33757175<br />continent: Africa","gdpPercap:   824<br />lifeExp: 42.1<br />pop:   19951656<br />continent: Africa","gdpPercap:  4811<br />lifeExp: 52.9<br />pop:    2055080<br />continent: Africa","gdpPercap:   620<br />lifeExp: 56.9<br />pop:   12894865<br />continent: Africa","gdpPercap:  2014<br />lifeExp: 46.9<br />pop:  135031164<br />continent: Africa","gdpPercap:  7670<br />lifeExp: 76.4<br />pop:     798094<br />continent: Africa","gdpPercap:   863<br />lifeExp: 46.2<br />pop:    8860588<br />continent: Africa","gdpPercap:  1598<br />lifeExp: 65.5<br />pop:     199579<br />continent: Africa","gdpPercap:  1712<br />lifeExp: 63.1<br />pop:   12267493<br />continent: Africa","gdpPercap:   863<br />lifeExp: 42.6<br />pop:    6144562<br />continent: Africa","gdpPercap:   926<br />lifeExp: 48.2<br />pop:    9118773<br />continent: Africa","gdpPercap:  9270<br />lifeExp: 49.3<br />pop:   43997828<br />continent: Africa","gdpPercap:  2602<br />lifeExp: 58.6<br />pop:   42292929<br />continent: Africa","gdpPercap:  4513<br />lifeExp: 39.6<br />pop:    1133066<br />continent: Africa","gdpPercap:  1107<br />lifeExp: 52.5<br />pop:   38139640<br />continent: Africa","gdpPercap:   883<br />lifeExp: 58.4<br />pop:    5701579<br />continent: Africa","gdpPercap:  7093<br />lifeExp: 73.9<br />pop:   10276158<br />continent: Africa","gdpPercap:  1056<br />lifeExp: 51.5<br />pop:   29170398<br />continent: Africa","gdpPercap:  1271<br />lifeExp: 42.4<br />pop:   11746035<br />continent: Africa","gdpPercap:   470<br />lifeExp: 43.5<br />pop:   12311143<br />continent: Africa"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":[6.7752717325492302,5.5989004118630001,5.2403533070783466,4.4039576839973833,5.7356199392207996,5.2690143958143745,5.9564773609874049,4.8422259478740974,5.4285263116604412,4.1516985016395616,7.9562662998770968,4.7671332830722601,5.9761166381701099,4.0630571938388131,8.4363687173296391,4.0881362755000454,4.9086539137274148,8.32592567062337,4.3626259687113649,4.4145446751277628,6.2577023306009796,5.4044519713261234,4.366601197011196,6.8764961358924266,4.4803007102230001,4.6801077545067349,5.0369392016926247,6.0461636385333,5.6651779774839266,5.5697344023561026,4.6914832316617332,4.3131500431206629,6.7943767241052386,6.0925324617448933,4.4884533308975465,5.6338762963755968,9.8227139332733113,4.1821590023924538,5.3111594952501031,3.7795275590551185,5.5874769596414557,5.0484803839022625,5.3338208539114369,7.2238082937782924,7.156106546896897,4.282361176813005,6.9852002740989851,5.0002880392083817,5.4315910179617095,6.5807690784340016,5.5479846257867891,5.5907437114111733],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"Africa","legendgroup":"Africa","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.1065097720176862,3.5823062593168782,3.957406173408569,4.5601366924251883,4.1196398143870931,3.8455061110473117,3.9843049975871763,3.9517309708016475,3.7799840633073747,3.8371629195761865,3.7580298117512663,3.7148366998460376,3.0797733480287044,3.550024106620056,3.8645633037284566,4.0783688975107708,3.4392254438054342,3.991632953509189,3.6204315729333021,3.8697540590018766,4.2862028478952521,4.2554777630339444,4.6329798832790043,4.0257752637018411,4.0575065679833457],"y":[75.319999999999993,65.554000000000002,72.390000000000001,80.653000000000006,78.552999999999997,72.888999999999996,78.781999999999996,78.272999999999996,72.234999999999999,74.994,71.878,70.259,60.915999999999997,70.197999999999993,72.566999999999993,76.194999999999993,72.899000000000001,75.537000000000006,71.751999999999995,71.421000000000006,78.745999999999995,69.819000000000003,78.242000000000004,76.384,73.747],"text":["gdpPercap: 12779<br />lifeExp: 75.3<br />pop:   40301927<br />continent: Americas","gdpPercap:  3822<br />lifeExp: 65.6<br />pop:    9119152<br />continent: Americas","gdpPercap:  9066<br />lifeExp: 72.4<br />pop:  190010647<br />continent: Americas","gdpPercap: 36319<br />lifeExp: 80.7<br />pop:   33390141<br />continent: Americas","gdpPercap: 13172<br />lifeExp: 78.6<br />pop:   16284741<br />continent: Americas","gdpPercap:  7007<br />lifeExp: 72.9<br />pop:   44227550<br />continent: Americas","gdpPercap:  9645<br />lifeExp: 78.8<br />pop:    4133884<br />continent: Americas","gdpPercap:  8948<br />lifeExp: 78.3<br />pop:   11416987<br />continent: Americas","gdpPercap:  6025<br />lifeExp: 72.2<br />pop:    9319622<br />continent: Americas","gdpPercap:  6873<br />lifeExp: 75.0<br />pop:   13755680<br />continent: Americas","gdpPercap:  5728<br />lifeExp: 71.9<br />pop:    6939688<br />continent: Americas","gdpPercap:  5186<br />lifeExp: 70.3<br />pop:   12572928<br />continent: Americas","gdpPercap:  1202<br />lifeExp: 60.9<br />pop:    8502814<br />continent: Americas","gdpPercap:  3548<br />lifeExp: 70.2<br />pop:    7483763<br />continent: Americas","gdpPercap:  7321<br />lifeExp: 72.6<br />pop:    2780132<br />continent: Americas","gdpPercap: 11978<br />lifeExp: 76.2<br />pop:  108700891<br />continent: Americas","gdpPercap:  2749<br />lifeExp: 72.9<br />pop:    5675356<br />continent: Americas","gdpPercap:  9809<br />lifeExp: 75.5<br />pop:    3242173<br />continent: Americas","gdpPercap:  4173<br />lifeExp: 71.8<br />pop:    6667147<br />continent: Americas","gdpPercap:  7409<br />lifeExp: 71.4<br />pop:   28674757<br />continent: Americas","gdpPercap: 19329<br />lifeExp: 78.7<br />pop:    3942491<br />continent: Americas","gdpPercap: 18009<br />lifeExp: 69.8<br />pop:    1056608<br />continent: Americas","gdpPercap: 42952<br />lifeExp: 78.2<br />pop:  301139947<br />continent: Americas","gdpPercap: 10611<br />lifeExp: 76.4<br />pop:    3447496<br />continent: Americas","gdpPercap: 11416<br />lifeExp: 73.7<br />pop:   26084662<br />continent: Americas"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","opacity":1,"size":[7.0752836928954501,5.333853876564663,10.949722028706249,6.7778440362522812,5.8668180179899734,7.2328291141492445,4.8118234074533222,5.5226039735491259,5.3512237886724172,5.69571313317988,5.1306777542305024,5.6102133034773436,5.2791910995855069,5.1841532973733377,4.6155666029278022,9.2006306129298405,4.9973754404969783,4.687331723294788,5.1030785274449162,6.5567034863678497,4.7864012116365817,4.2613288143832744,12.807919245623044,4.7174623155002786,6.4273871341173354],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(163,165,0,1)"}},"hoveron":"points","name":"Americas","legendgroup":"Americas","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2.9888176454912858,4.4741586701859664,3.1434063610570009,3.2339547372751722,3.6954041667466049,4.5990636726886356,3.3895577312128795,3.5490831898821575,4.0646718823630357,3.6504106831196688,4.406936435530084,4.5004569709846161,3.6550866594992835,3.2022336270366805,4.3682522837381041,4.6749253140699576,4.0195756382230385,4.095227107013149,3.4907690059237622,2.9749719942980688,3.0379679438446519,4.3486201061894318,3.4159656754035375,3.5038561648270914,4.3355548175826542,4.6734188707962172,3.5988009435983197,3.6216485631534296,4.4581583777244909,3.8726454573379581,3.3876703191654678,3.4807755960325997,3.3580814739680283],"y":[43.828000000000003,75.635000000000005,64.061999999999998,59.722999999999999,72.960999999999999,82.207999999999998,64.697999999999993,70.650000000000006,70.963999999999999,59.545000000000002,80.745000000000005,82.602999999999994,72.534999999999997,67.296999999999997,78.623000000000005,77.587999999999994,71.992999999999995,74.241,66.802999999999997,62.069000000000003,63.784999999999997,75.640000000000001,65.483000000000004,71.688000000000002,72.777000000000001,79.971999999999994,72.396000000000001,74.143000000000001,78.400000000000006,70.616,74.248999999999995,73.421999999999997,62.698],"text":["gdpPercap:   975<br />lifeExp: 43.8<br />pop:   31889923<br />continent: Asia","gdpPercap: 29796<br />lifeExp: 75.6<br />pop:     708573<br />continent: Asia","gdpPercap:  1391<br />lifeExp: 64.1<br />pop:  150448339<br />continent: Asia","gdpPercap:  1714<br />lifeExp: 59.7<br />pop:   14131858<br />continent: Asia","gdpPercap:  4959<br />lifeExp: 73.0<br />pop: 1318683096<br />continent: Asia","gdpPercap: 39725<br />lifeExp: 82.2<br />pop:    6980412<br />continent: Asia","gdpPercap:  2452<br />lifeExp: 64.7<br />pop: 1110396331<br />continent: Asia","gdpPercap:  3541<br />lifeExp: 70.7<br />pop:  223547000<br />continent: Asia","gdpPercap: 11606<br />lifeExp: 71.0<br />pop:   69453570<br />continent: Asia","gdpPercap:  4471<br />lifeExp: 59.5<br />pop:   27499638<br />continent: Asia","gdpPercap: 25523<br />lifeExp: 80.7<br />pop:    6426679<br />continent: Asia","gdpPercap: 31656<br />lifeExp: 82.6<br />pop:  127467972<br />continent: Asia","gdpPercap:  4519<br />lifeExp: 72.5<br />pop:    6053193<br />continent: Asia","gdpPercap:  1593<br />lifeExp: 67.3<br />pop:   23301725<br />continent: Asia","gdpPercap: 23348<br />lifeExp: 78.6<br />pop:   49044790<br />continent: Asia","gdpPercap: 47307<br />lifeExp: 77.6<br />pop:    2505559<br />continent: Asia","gdpPercap: 10461<br />lifeExp: 72.0<br />pop:    3921278<br />continent: Asia","gdpPercap: 12452<br />lifeExp: 74.2<br />pop:   24821286<br />continent: Asia","gdpPercap:  3096<br />lifeExp: 66.8<br />pop:    2874127<br />continent: Asia","gdpPercap:   944<br />lifeExp: 62.1<br />pop:   47761980<br />continent: Asia","gdpPercap:  1091<br />lifeExp: 63.8<br />pop:   28901790<br />continent: Asia","gdpPercap: 22316<br />lifeExp: 75.6<br />pop:    3204897<br />continent: Asia","gdpPercap:  2606<br />lifeExp: 65.5<br />pop:  169270617<br />continent: Asia","gdpPercap:  3190<br />lifeExp: 71.7<br />pop:   91077287<br />continent: Asia","gdpPercap: 21655<br />lifeExp: 72.8<br />pop:   27601038<br />continent: Asia","gdpPercap: 47143<br />lifeExp: 80.0<br />pop:    4553009<br />continent: Asia","gdpPercap:  3970<br />lifeExp: 72.4<br />pop:   20378239<br />continent: Asia","gdpPercap:  4185<br />lifeExp: 74.1<br />pop:   19314747<br />continent: Asia","gdpPercap: 28718<br />lifeExp: 78.4<br />pop:   23174294<br />continent: Asia","gdpPercap:  7458<br />lifeExp: 70.6<br />pop:   65068149<br />continent: Asia","gdpPercap:  2442<br />lifeExp: 74.2<br />pop:   85262356<br />continent: Asia","gdpPercap:  3025<br />lifeExp: 73.4<br />pop:    4018332<br />continent: Asia","gdpPercap:  2281<br />lifeExp: 62.7<br />pop:   22211743<br />continent: Asia"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,125,1)","opacity":1,"size":[6.7092983513552849,4.1508288847181953,10.158865608179935,5.7221180107506537,22.677165354330711,5.1347534580541501,21.120368095307143,11.557396830375804,8.1105713155374861,6.4987952406877376,5.0782402616746616,9.6507758736364799,5.0386912985713304,6.2810035011451255,7.4168446506103951,4.569838394810894,4.7835439230220365,6.3619616591074761,4.6306565167244802,7.368763875897594,6.5677527377566554,4.6817536552960464,10.5466615830696,8.7408659686259185,6.5038406176847667,4.8654178527954128,6.1173758740791646,6.0549352830716545,6.2740949140912097,7.9711999339905422,8.5795132943757064,4.7965509761407246,6.2212794811128056],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,125,1)"}},"hoveron":"points","name":"Asia","legendgroup":"Asia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[3.7735692087621691,4.5578258006221848,4.5275345915133105,3.8719404594797928,4.0286034909483179,4.1649242825131747,4.3585688446278343,4.5475091108168488,4.5212307459814749,4.4838726922507623,4.5074561155365247,4.4399388911990529,4.2554882582210949,4.5584780356339154,4.6093381996914395,4.4559059795027833,3.9663246195778949,4.5658234281049346,4.6933504280025318,4.1872364943512697,4.3119582019159575,4.0337644468812863,3.9906289409349966,4.271337680163577,4.4110850532178922,4.4597100052953031,4.5296837260525233,4.574105601810623,3.927281872119107,4.5211807429313629],"y":[76.423000000000002,79.828999999999994,79.441000000000003,74.852000000000004,73.004999999999995,75.748000000000005,76.486000000000004,78.331999999999994,79.313000000000002,80.656999999999996,79.406000000000006,79.483000000000004,73.337999999999994,81.757000000000005,78.885000000000005,80.546000000000006,74.543000000000006,79.762,80.195999999999998,75.563000000000002,78.097999999999999,72.475999999999999,74.001999999999995,74.662999999999997,77.926000000000002,80.941000000000003,80.884,81.700999999999993,71.777000000000001,79.424999999999997],"text":["gdpPercap:  5937<br />lifeExp: 76.4<br />pop:    3600523<br />continent: Europe","gdpPercap: 36126<br />lifeExp: 79.8<br />pop:    8199783<br />continent: Europe","gdpPercap: 33693<br />lifeExp: 79.4<br />pop:   10392226<br />continent: Europe","gdpPercap:  7446<br />lifeExp: 74.9<br />pop:    4552198<br />continent: Europe","gdpPercap: 10681<br />lifeExp: 73.0<br />pop:    7322858<br />continent: Europe","gdpPercap: 14619<br />lifeExp: 75.7<br />pop:    4493312<br />continent: Europe","gdpPercap: 22833<br />lifeExp: 76.5<br />pop:   10228744<br />continent: Europe","gdpPercap: 35278<br />lifeExp: 78.3<br />pop:    5468120<br />continent: Europe","gdpPercap: 33207<br />lifeExp: 79.3<br />pop:    5238460<br />continent: Europe","gdpPercap: 30470<br />lifeExp: 80.7<br />pop:   61083916<br />continent: Europe","gdpPercap: 32170<br />lifeExp: 79.4<br />pop:   82400996<br />continent: Europe","gdpPercap: 27538<br />lifeExp: 79.5<br />pop:   10706290<br />continent: Europe","gdpPercap: 18009<br />lifeExp: 73.3<br />pop:    9956108<br />continent: Europe","gdpPercap: 36181<br />lifeExp: 81.8<br />pop:     301931<br />continent: Europe","gdpPercap: 40676<br />lifeExp: 78.9<br />pop:    4109086<br />continent: Europe","gdpPercap: 28570<br />lifeExp: 80.5<br />pop:   58147733<br />continent: Europe","gdpPercap:  9254<br />lifeExp: 74.5<br />pop:     684736<br />continent: Europe","gdpPercap: 36798<br />lifeExp: 79.8<br />pop:   16570613<br />continent: Europe","gdpPercap: 49357<br />lifeExp: 80.2<br />pop:    4627926<br />continent: Europe","gdpPercap: 15390<br />lifeExp: 75.6<br />pop:   38518241<br />continent: Europe","gdpPercap: 20510<br />lifeExp: 78.1<br />pop:   10642836<br />continent: Europe","gdpPercap: 10808<br />lifeExp: 72.5<br />pop:   22276056<br />continent: Europe","gdpPercap:  9787<br />lifeExp: 74.0<br />pop:   10150265<br />continent: Europe","gdpPercap: 18678<br />lifeExp: 74.7<br />pop:    5447502<br />continent: Europe","gdpPercap: 25768<br />lifeExp: 77.9<br />pop:    2009245<br />continent: Europe","gdpPercap: 28821<br />lifeExp: 80.9<br />pop:   40448191<br />continent: Europe","gdpPercap: 33860<br />lifeExp: 80.9<br />pop:    9031088<br />continent: Europe","gdpPercap: 37506<br />lifeExp: 81.7<br />pop:    7554661<br />continent: Europe","gdpPercap:  8458<br />lifeExp: 71.8<br />pop:   71158647<br />continent: Europe","gdpPercap: 33203<br />lifeExp: 79.4<br />pop:   60776238<br />continent: Europe"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","opacity":1,"size":[4.7393036097654502,5.2515712457990968,5.4410784978691735,4.8653167028921844,5.1685528258485842,4.8579469438752234,5.4276996527368331,4.9741078643628294,4.9477814048195228,7.8404337662196868,8.498091237446733,5.4664828069929365,5.4051430840065446,3.9460291298414996,4.8085649745634003,7.7413040551619607,4.1420303205279438,5.8852844160763711,4.8747213942514058,7.0011551525914504,5.4613810121458615,6.2248439161044908,5.421238450332476,4.9717681273532666,4.4796425578879777,7.0812884751230953,5.3261618194654057,5.1909724557450065,8.1635636391520627,7.8301599085784517],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,176,246,1)"}},"hoveron":"points","name":"Europe","legendgroup":"Europe","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.5370047214526892,4.4011421122881123],"y":[81.234999999999999,80.203999999999994],"text":["gdpPercap: 34435<br />lifeExp: 81.2<br />pop:   20434176<br />continent: Oceania","gdpPercap: 25185<br />lifeExp: 80.2<br />pop:    4115771<br />continent: Oceania"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(231,107,243,1)","opacity":1,"size":[6.1206139909462598,4.8094443919586789],"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(231,107,243,1)"}},"hoveron":"points","name":"Oceania","legendgroup":"Oceania","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":23.305936073059364,"r":7.3059360730593621,"b":37.260273972602747,"l":37.260273972602747},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[2.330843825648564,4.8058507424003398],"tickmode":"array","ticktext":["300","1000","3000","10000","30000"],"tickvals":[2.4771212547196626,3,3.4771212547196626,4,4.4771212547196626],"categoryorder":"array","categoryarray":["300","1000","3000","10000","30000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"gdpPercap","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[37.463499999999996,84.752499999999998],"tickmode":"array","ticktext":["40","50","60","70","80"],"tickvals":[40,50,60,70,80],"categoryorder":"array","categoryarray":["40","50","60","70","80"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"lifeExp","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"pop<br />continent","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"c2484bd554d1":{"x":{},"y":{},"size":{},"colour":{},"type":"scatter"}},"cur_data":"c2484bd554d1","visdat":{"c2484bd554d1":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
]

---
class: hide_logo
background-image: url(imgs/logo-plotnine.webp)
background-size: 5%
background-position: 5% 3%

### &amp;emsp;&amp;emsp;`plotnine`: A Grammar of Graphics for Python

&lt;iframe src="https://plotnine.readthedocs.io/" width="100%" height="540px" data-external="1"&gt;&lt;/iframe&gt;

---
class: inverse, center, middle

# 课后复习与作业

---
class: middle

.font130[
🕐 根据课程讲义的打印稿，在 📑 _R Script_ 中键入并完成全部代码的运行

🕑 请复习 / 进一步学习 📖 .bold[[{{_R for Data Science, 2e_}}](https://r4ds.hadley.nz/)] &lt;sup&gt;*&lt;/sup&gt; 一书关于数据可视化的第2章（Data visualization）、第10章（Layers）和__第12章（Communication）__以及关于工作流的第3、5、7、9章）

🕒 下载（打印）📰 .bold[[{{ggplot2-cheatsheet}}](docs/ggplot2-cheatsheet.pdf)] 并浏览之

🕓 登录浏览 🖼 .bold[[{{The R Graph Gallery}}](https://www.r-graph-gallery.com/index.html)]

🕔 登录浏览 📦 .bold[[{{ggplot2 extentions}}](https://exts.ggplot2.tidyverse.org/gallery/)]，进一步了解 `ggplot2` 包的“生态圈”

🕕 _**进阶内容**_：R 对中文字体的支持不够理想，可参考 📝 .bold[[{{_RJournal_的文章}}](https://journal.r-project.org/archive/2015-1/qiu.pdf)]以及帖子 .bold[[{{showtext}}](https://cosx.org/2014/01/showtext-interesting-fonts-and-graphs)] 中提到的解决方案和有趣示例

&lt;br&gt;
]

.footnote.red[
\* 若英文看起来实在吃力 😵， 这本书的第一版有中文翻译版，请同学们自行学习对应章节。我个人建议同学们（等网上商城打折时）购买实体书，放在案头作学习参考。]

---
class: middle

.font120[
🕐 根据 L2 课程讲义的打印稿，在 📑 _R Script_ 中键入并完成全部代码的运行
]

--

- .bold[打开新的 R script 文件]
  - .kbd[`Ctrl+Shift+N`] 打开 -&gt; .kbd[`Ctrl+S`] 存盘为“_L02_coding_practice.R_”
  - 注：文件保存路径和文件名最好为英文，中间不要有空格

--
  
- .bold[输入与运行代码]
  - 长代码手动断行，最好不要超过80个字符
  - 灵活使用快捷键，如 .kbd[`F1`]（帮助）、.kbd[`Tab`]（代码提示与自动补全）、.kbd[`Ctrl+A`]（选中全部代码） -&gt; .kbd[`Ctrl+Shift+A`]（代码重新格式化）等
  - .kbd[`Ctrl+Enter`] 运行光标所在行或选中代码（.kbd[`Ctrl+Alt+R`] 运行全部代码，.kbd[`Ctrl+Shift+P`] 重新运行代码，.kbd[`Ctrl+Alt+P`] 运行光标前的代码）

--

- .bold[注释]
  - 以 # 作为注释开始标记，如说明性文字、区分不同代码块（.kbd[`Ctrl+Shift+R`]）
  - 最后加入一段注释说明，简单说说使用 ggplot2包 的体会
  
--

- .bold[提交代码]

  - 可结队编写代码，共同署名，分别提交，**但注意控制雷同比例**
  - 2023年9月28日22:00前通过 [{{坚果云链接}}](https://send2me.cn/mhGkgKHx/S_mh3x3-oCKUzg) 直接提交代码文档

---
class: center middle
background-image: url(imgs/xaringan.png)
background-size: 12%
background-position: 50% 40%

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
&lt;hr color='#f00' size='2px' width='80%'&gt;
&lt;br&gt;
.Large.red[_**本网页版讲义的制作由 R 包 [{{`xaringan`}}](https://github.com/yihui/xaringan) 赋能！**_]

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="../libs/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
